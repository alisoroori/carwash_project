Options -Indexes
ServerSignature Off

<IfModule mod_headers.c>
    Header set X-XSS-Protection "1; mode=block"
    Header set X-Content-Type-Options "nosniff"
    
    # Ensure CSS responses include charset for proper text encoding handling
    <FilesMatch "\.css$">
        Header set Content-Type "text/css; charset=UTF-8"
    </FilesMatch>

    # Ensure correct MIME type for WOFF2 fonts
    <FilesMatch "\.woff2$">
        # Set explicit MIME type without charset
        Header set Content-Type "font/woff2"
        # Remove any charset parameter if it was added by other directives
        Header edit Content-Type ";\s*charset=[^\"]+" ""
    </FilesMatch>

    # Unset X-XSS-Protection for static resources (images, scripts, styles, fonts)
    <FilesMatch "\.(?:css|js|png|jpg|jpeg|gif|svg|webp|avif|ico|woff2|woff|ttf|eot)$">
        Header unset X-XSS-Protection
    </FilesMatch>

    # Ensure "Expires" header is not sent by the server; rely on Cache-Control instead
    # Use "always" so headers added by backend scripts or other modules are also removed
    Header always unset Expires

    # Add long-term caching headers for immutable static assets
    <FilesMatch "\.(?:css|js|png|jpg|jpeg|gif|svg|webp|avif|ico|woff2|woff|ttf|eot)$">
        Header set Cache-Control "max-age=31536000, immutable"
    </FilesMatch>
</IfModule>

# Block access to sensitive files
<FilesMatch "^(\.env|package\.json|\.*rc)">
    Order allow,deny
    Deny from all
</FilesMatch>

# Allow composer.json to be accessed (needed for PSR-4 autoloading)
# <FilesMatch "^(composer\.json)">
#     Order allow,deny
#     Allow from all
# </FilesMatch>

# Prevent directory listing
Options -Indexes

# Default charset for text media types (fallback for servers that respect this)
AddDefaultCharset UTF-8

# غیرفعال کردن موتور PHP
<IfModule mod_php7.c>
    php_flag engine off
</IfModule>

<IfModule mod_php8.c>
    php_flag engine off
</IfModule>