<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Validation Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-case {
            margin: 15px 0;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
        }
        .pass {
            border-color: #4caf50;
            background: #f1f8f4;
        }
        .fail {
            border-color: #f44336;
            background: #fef5f5;
        }
        .result {
            font-weight: bold;
            margin-top: 10px;
        }
        .pass .result {
            color: #4caf50;
        }
        .fail .result {
            color: #f44336;
        }
        h1 {
            color: #333;
        }
        h2 {
            color: #555;
            border-bottom: 2px solid #2196f3;
            padding-bottom: 10px;
        }
        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }
        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .summary {
            background: #fff3cd;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            border-left: 4px solid #ffc107;
        }
    </style>
</head>
<body>
    <h1>üß™ Profile Validation Test Suite</h1>
    
    <div class="info">
        <strong>Test Objective:</strong> Verify that profile form validation only triggers for fields that have been modified by the user, matching the backend behavior.
    </div>

    <div class="test-section">
        <h2>Username Validation Logic</h2>
        <p><strong>Regex Pattern:</strong> <code>/^[A-Za-z0-9_]{3,}$/</code></p>
        <p><strong>Requirements:</strong></p>
        <ul>
            <li>At least 3 characters</li>
            <li>Only alphanumeric characters and underscores</li>
            <li>No spaces allowed</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>Test Cases: Valid Usernames</h2>
        <div id="validTests"></div>
    </div>

    <div class="test-section">
        <h2>Test Cases: Invalid Usernames</h2>
        <div id="invalidTests"></div>
    </div>

    <div class="test-section">
        <h2>Test Cases: Change Detection</h2>
        <div id="changeDetectionTests"></div>
    </div>

    <div class="summary" id="summary"></div>

    <script>
        const usernameRegex = /^[A-Za-z0-9_]{3,}$/;

        const validUsernames = [
            'john_doe',
            'user123',
            'admin',
            'test_user_123',
            'ABC',
            'username_with_numbers_123',
            '123456',
            'a_b_c',
            'User_Name',
            'test'
        ];

        const invalidUsernames = [
            'ab', // too short
            'us', // too short
            'user name', // contains space
            'user-name', // contains dash
            'user@name', // contains @
            'user.name', // contains dot
            'user name 123', // contains spaces
            '', // empty
            'u', // too short
            'ab@cd', // contains @
        ];

        const changeDetectionScenarios = [
            {
                original: 'john_doe',
                modified: 'john_doe',
                shouldValidate: false,
                description: 'Same username (no change)'
            },
            {
                original: 'john_doe',
                modified: 'jane_doe',
                shouldValidate: true,
                description: 'Changed username (valid ‚Üí valid)'
            },
            {
                original: 'john_doe',
                modified: 'ab',
                shouldValidate: true,
                description: 'Changed username (valid ‚Üí invalid)'
            },
            {
                original: '',
                modified: 'john_doe',
                shouldValidate: true,
                description: 'Empty ‚Üí Valid username'
            }
        ];

        let passCount = 0;
        let failCount = 0;

        function testUsername(username, expectedValid, containerEl) {
            const isValid = usernameRegex.test(username);
            const passed = isValid === expectedValid;
            
            if (passed) passCount++;
            else failCount++;

            const testCase = document.createElement('div');
            testCase.className = `test-case ${passed ? 'pass' : 'fail'}`;
            testCase.innerHTML = `
                <strong>Input:</strong> <code>"${username || '(empty)'}"</code><br>
                <strong>Expected:</strong> ${expectedValid ? 'VALID ‚úì' : 'INVALID ‚úó'}<br>
                <strong>Result:</strong> ${isValid ? 'VALID ‚úì' : 'INVALID ‚úó'}
                <div class="result">${passed ? '‚úÖ PASS' : '‚ùå FAIL'}</div>
            `;
            containerEl.appendChild(testCase);
        }

        function testChangeDetection(scenario, containerEl) {
            const changed = scenario.original !== scenario.modified;
            const passed = changed === scenario.shouldValidate;
            
            if (passed) passCount++;
            else failCount++;

            const testCase = document.createElement('div');
            testCase.className = `test-case ${passed ? 'pass' : 'fail'}`;
            testCase.innerHTML = `
                <strong>Scenario:</strong> ${scenario.description}<br>
                <strong>Original:</strong> <code>"${scenario.original || '(empty)'}"</code><br>
                <strong>Modified:</strong> <code>"${scenario.modified || '(empty)'}"</code><br>
                <strong>Should Validate:</strong> ${scenario.shouldValidate ? 'YES' : 'NO'}<br>
                <strong>Change Detected:</strong> ${changed ? 'YES' : 'NO'}
                <div class="result">${passed ? '‚úÖ PASS' : '‚ùå FAIL'}</div>
            `;
            containerEl.appendChild(testCase);
        }

        // Run tests
        const validTestsContainer = document.getElementById('validTests');
        validUsernames.forEach(username => testUsername(username, true, validTestsContainer));

        const invalidTestsContainer = document.getElementById('invalidTests');
        invalidUsernames.forEach(username => testUsername(username, false, invalidTestsContainer));

        const changeDetectionContainer = document.getElementById('changeDetectionTests');
        changeDetectionScenarios.forEach(scenario => testChangeDetection(scenario, changeDetectionContainer));

        // Summary
        const total = passCount + failCount;
        const summaryEl = document.getElementById('summary');
        summaryEl.innerHTML = `
            <h3>üìä Test Summary</h3>
            <p><strong>Total Tests:</strong> ${total}</p>
            <p><strong>Passed:</strong> <span style="color: #4caf50; font-weight: bold;">${passCount}</span></p>
            <p><strong>Failed:</strong> <span style="color: #f44336; font-weight: bold;">${failCount}</span></p>
            <p><strong>Success Rate:</strong> ${((passCount / total) * 100).toFixed(1)}%</p>
        `;
    </script>
</body>
</html>
