<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sidebar Position Test - No Footer Overlap</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f9fafb;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Fixed Header - 80px height */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: white;
            border-bottom: 1px solid #e5e7eb;
            z-index: 50;
            display: flex;
            align-items: center;
            padding: 0 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        header h1 {
            font-size: 1.5rem;
            color: #1f2937;
        }
        
        /* Fixed Sidebar - Positioned between header and footer */
        #sidebar {
            position: fixed;
            top: 80px;
            bottom: 0;  /* Will be overridden by JavaScript */
            left: 0;
            width: 250px;
            background: linear-gradient(to bottom, #2563eb, #7c3aed);
            color: white;
            overflow-y: auto;
            z-index: 30;
            padding: 1rem;
            box-shadow: 4px 0 15px rgba(0,0,0,0.1);
        }
        
        #sidebar nav {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        #sidebar a {
            padding: 0.75rem 1rem;
            color: white;
            text-decoration: none;
            border-radius: 0.5rem;
            transition: background 0.2s;
        }
        
        #sidebar a:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* Main Content */
        #main-content {
            margin-left: 250px;
            margin-top: 80px;
            padding: 2rem;
            min-height: calc(100vh - 80px);
            flex: 1;
        }
        
        .content-section {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        /* Footer - Full Width */
        footer {
            position: relative;
            background: #111827;
            color: white;
            padding: 3rem 2rem;
            width: 100%;
            margin-left: 0;
            z-index: 40;
        }
        
        footer .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }
        
        footer h3 {
            margin-bottom: 1rem;
            color: white;
        }
        
        footer p {
            color: #9ca3af;
            line-height: 1.6;
        }
        
        /* Status Indicator */
        #status {
            position: fixed;
            top: 90px;
            right: 1rem;
            background: white;
            border: 2px solid #10b981;
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 60;
            max-width: 300px;
        }
        
        #status h4 {
            color: #10b981;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        #status p {
            font-size: 0.875rem;
            color: #6b7280;
            margin: 0.25rem 0;
        }
        
        .metric {
            font-family: monospace;
            font-weight: bold;
            color: #2563eb;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            #sidebar {
                transform: translateX(-100%);
            }
            
            #main-content {
                margin-left: 0;
            }
            
            #status {
                position: static;
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Fixed Header -->
    <header>
        <h1>üöó Sidebar Position Test</h1>
    </header>
    
    <!-- Fixed Sidebar -->
    <aside id="sidebar" class="sidebar-fixed">
        <h2 style="margin-bottom: 1rem; font-size: 1.25rem;">Navigation</h2>
        <nav>
            <a href="#section1">üìä Dashboard</a>
            <a href="#section2">üöó Vehicles</a>
            <a href="#section3">üìÖ Reservations</a>
            <a href="#section4">üë§ Profile</a>
            <a href="#section5">‚öôÔ∏è Settings</a>
            <a href="#section6">üìù Section 6</a>
            <a href="#section7">üìù Section 7</a>
            <a href="#section8">üìù Section 8</a>
            <a href="#section9">üìù Section 9</a>
            <a href="#section10">üìù Section 10</a>
        </nav>
    </aside>
    
    <!-- Status Indicator -->
    <div id="status">
        <h4>‚úÖ Sidebar Positioning Active</h4>
        <p>Header Height: <span class="metric" id="header-height">-</span></p>
        <p>Footer Height: <span class="metric" id="footer-height">-</span></p>
        <p>Sidebar Top: <span class="metric" id="sidebar-top">-</span></p>
        <p>Sidebar Bottom: <span class="metric" id="sidebar-bottom">-</span></p>
        <p>Sidebar Max Height: <span class="metric" id="sidebar-maxheight">-</span></p>
        <p style="margin-top: 0.5rem; color: #10b981; font-weight: bold;">
            ‚úì Sidebar stops above footer
        </p>
    </div>
    
    <!-- Main Content -->
    <main id="main-content">
        <div class="content-section" id="section1">
            <h2>üìä Dashboard Section</h2>
            <p>This page demonstrates correct sidebar positioning without footer overlap.</p>
            <p><strong>Key Features:</strong></p>
            <ul style="margin: 1rem 0; padding-left: 2rem; line-height: 1.8;">
                <li>Sidebar positioned between header (80px) and footer</li>
                <li>JavaScript dynamically calculates sidebar height</li>
                <li>Sidebar bottom edge stops above footer top edge</li>
                <li>No overlap when scrolling to bottom of page</li>
                <li>Responsive to window resize events</li>
                <li>MutationObserver watches for footer changes</li>
            </ul>
        </div>
        
        <div class="content-section" id="section2">
            <h2>üöó Vehicles Section</h2>
            <p>Scroll down to test sidebar behavior. The sidebar should always stop above the footer.</p>
            <div style="height: 300px; background: linear-gradient(to bottom, #eff6ff, #dbeafe); border-radius: 0.5rem; margin-top: 1rem; display: flex; align-items: center; justify-content: center; color: #1e40af; font-weight: bold;">
                Content Area - 300px tall
            </div>
        </div>
        
        <div class="content-section" id="section3">
            <h2>üìÖ Reservations Section</h2>
            <p>Continue scrolling to reach the footer. Watch the sidebar position.</p>
            <div style="height: 400px; background: linear-gradient(to bottom, #f0fdf4, #dcfce7); border-radius: 0.5rem; margin-top: 1rem; display: flex; align-items: center; justify-content: center; color: #166534; font-weight: bold;">
                Content Area - 400px tall
            </div>
        </div>
        
        <div class="content-section" id="section4">
            <h2>üë§ Profile Section</h2>
            <p>The sidebar should remain visible and not overlap the footer.</p>
            <div style="height: 350px; background: linear-gradient(to bottom, #fef3c7, #fde68a); border-radius: 0.5rem; margin-top: 1rem; display: flex; align-items: center; justify-content: center; color: #92400e; font-weight: bold;">
                Content Area - 350px tall
            </div>
        </div>
        
        <div class="content-section" id="section5">
            <h2>‚öôÔ∏è Settings Section (Final)</h2>
            <p><strong>Scroll to the very bottom of this page.</strong></p>
            <p>Expected behavior:</p>
            <ul style="margin: 1rem 0; padding-left: 2rem; line-height: 1.8;">
                <li>‚úÖ Sidebar bottom edge aligns with footer top edge</li>
                <li>‚úÖ No overlap between sidebar and footer</li>
                <li>‚úÖ Sidebar maintains internal scrolling if content is long</li>
                <li>‚úÖ Footer is fully visible and not covered</li>
            </ul>
            <div style="height: 500px; background: linear-gradient(to bottom, #fce7f3, #fbcfe8); border-radius: 0.5rem; margin-top: 1rem; display: flex; align-items: center; justify-content: center; color: #831843; font-weight: bold; font-size: 1.5rem;">
                Scroll to Bottom ‚Üì<br>Footer Should Be Fully Visible
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer id="site-footer">
        <div class="footer-content">
            <div>
                <h3>üöó MyCar</h3>
                <p>Turkey's most trusted car wash reservation platform.</p>
            </div>
            <div>
                <h3>Quick Links</h3>
                <p>Home | About | Contact | Services</p>
            </div>
            <div>
                <h3>Contact</h3>
                <p>Email: info@mycar.com<br>Phone: +90 123 456 7890</p>
            </div>
        </div>
        <div style="text-align: center; margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #374151; color: #9ca3af;">
            <p>&copy; 2025 MyCar. All rights reserved.</p>
        </div>
    </footer>
    
    <!-- Sidebar Positioning Script -->
    <script>
        (function() {
            'use strict';
            
            /**
             * Aligns sidebar between header and footer
             * Sets inline styles: top, bottom, maxHeight
             * Overrides CSS bottom: 0 to prevent footer overlap
             */
            function alignSidebarBetweenHeaderAndFooter() {
                const sidebar = document.getElementById('sidebar');
                
                // Only process if sidebar exists and has sidebar-fixed class
                if (!sidebar || !sidebar.classList.contains('sidebar-fixed')) {
                    console.warn('‚ö†Ô∏è Sidebar not found or missing sidebar-fixed class');
                    return;
                }
                
                const header = document.querySelector('header');
                const footer = document.querySelector('#site-footer');
                
                // Calculate heights (rounded to avoid subpixel issues)
                const headerHeight = header ? Math.round(header.getBoundingClientRect().height) : 80;
                const footerHeight = footer ? Math.round(footer.getBoundingClientRect().height) : 0;
                
                // Apply inline styles to override CSS
                sidebar.style.top = headerHeight + 'px';
                sidebar.style.bottom = footerHeight + 'px';
                sidebar.style.maxHeight = `calc(100vh - ${headerHeight}px - ${footerHeight}px)`;
                sidebar.style.overflowY = 'auto';
                
                // Update status indicator
                updateStatusIndicator(headerHeight, footerHeight, sidebar);
                
                console.log(`‚úÖ Sidebar aligned - Header: ${headerHeight}px, Footer: ${footerHeight}px`);
            }
            
            /**
             * Updates the status indicator with current measurements
             */
            function updateStatusIndicator(headerHeight, footerHeight, sidebar) {
                document.getElementById('header-height').textContent = headerHeight + 'px';
                document.getElementById('footer-height').textContent = footerHeight + 'px';
                document.getElementById('sidebar-top').textContent = sidebar.style.top;
                document.getElementById('sidebar-bottom').textContent = sidebar.style.bottom;
                document.getElementById('sidebar-maxheight').textContent = sidebar.style.maxHeight;
            }
            
            /**
             * Debounce function to limit resize event frequency
             */
            function debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
            
            // Initial alignment on DOM ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', alignSidebarBetweenHeaderAndFooter);
            } else {
                alignSidebarBetweenHeaderAndFooter();
            }
            
            // Re-align after all resources loaded
            window.addEventListener('load', alignSidebarBetweenHeaderAndFooter);
            
            // Re-align on window resize (debounced)
            window.addEventListener('resize', debounce(alignSidebarBetweenHeaderAndFooter, 120));
            
            // Watch for footer content changes
            const footer = document.querySelector('#site-footer');
            if (footer) {
                const observer = new MutationObserver(debounce(alignSidebarBetweenHeaderAndFooter, 100));
                observer.observe(footer, {
                    attributes: true,
                    childList: true,
                    subtree: true,
                    characterData: true
                });
                console.log('üëÄ MutationObserver watching footer for changes');
            }
            
            console.log('‚úÖ Sidebar positioning script initialized');
            
            // Test: Dynamically change footer height after 3 seconds
            setTimeout(() => {
                console.log('üß™ TEST: Adding extra content to footer...');
                const testDiv = document.createElement('div');
                testDiv.style.cssText = 'margin-top: 2rem; padding: 2rem; background: rgba(255,255,255,0.1); border-radius: 0.5rem; text-align: center;';
                testDiv.innerHTML = '<p style="color: #fbbf24; font-weight: bold; margin: 0;">‚ö†Ô∏è TEST: Footer height changed! Sidebar should auto-adjust.</p>';
                footer.querySelector('.footer-content').appendChild(testDiv);
            }, 3000);
            
        })();
    </script>
</body>
</html>
